<a href="/tasks/{{ task.id }}" class="flex flex-col border border-sand-300 rounded-xl bg-white/40 hover:bg-white/70 hover:border-sand-400 transition-colors {{ task.deadline|deadline_card_css }} overflow-hidden">
    <div class="px-5 pt-5 pb-2 flex-1">
        <!-- Header: ID + status + priority -->
        <div class="flex justify-between items-start mb-3">
            <span class="font-mono text-2xs text-ink-muted">#{{ "%03d"|format(task.id) }}</span>
            <div class="flex items-center gap-2">
                <span class="inline-flex px-2 py-0.5 rounded-md text-2xs font-medium {{ task.status|status_badge }}">
                    {{ task.status|status_label }}
                </span>
                <span class="text-2xs text-ink-tertiary">{{ task.priority }}</span>
            </div>
        </div>

        <!-- Amount -->
        <div class="text-ink text-sm font-medium mb-1.5">
            {{ task.amount_total|format_amount(task.payment_note) }}
        </div>

        <!-- Description -->
        {% if task.description %}
        <p class="text-[13px] text-ink-tertiary line-clamp-2">
            {{ task.description[:80] }}{% if task.description|length > 80 %}â€¦{% endif %}
        </p>
        {% endif %}

        <!-- Metadata: fan + platform -->
        <div class="flex items-center gap-2 text-2xs text-ink-muted">
            {% if task.fan_name %}
            <span>{{ task.fan_name }}</span>
            {% endif %}
            {% if task.platform %}
            <span class="text-ink-faint">/</span>
            <span>{{ task.platform|platform_label }}</span>
            {% endif %}
        </div>

        <!-- Duration -->
        {% if task.duration %}
        <div class="text-2xs text-ink-muted mt-1.5">{{ task.duration }}</div>
        {% endif %}
    </div>

    <!-- Deadline counter -->
    {% if task.deadline %}
    {% set counter = task.deadline|deadline_counter %}
    {% if counter.show %}
    <div class="border-t border-sand-200 px-5 py-3 flex items-center gap-3">
        <span class="text-xl font-semibold tabular-nums font-mono {{ counter.css }}">{{ counter.number }}</span>
        <span class="text-[13px] {{ counter.css }}">{{ counter.label }}</span>
    </div>
    {% else %}
    <div class="border-t border-sand-200 px-5 py-2.5">
        <span class="text-[13px] {{ task.deadline|deadline_css }}">{{ task.deadline|deadline_text }}</span>
    </div>
    {% endif %}
    {% endif %}
</a>
